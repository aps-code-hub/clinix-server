generator client {
    provider = "prisma-client-js"
    output   = "../../../node_modules/@generated/patient-client"
}

datasource db {
    provider = "postgresql"
    url      = env("PATIENT_DATABASE_URL")
}

enum Gender {
    MALE
    FEMALE
    OTHER
}

enum Status {
    ACTIVE
    INACTIVE
    SUSPENDED
}

enum BloodGroup {
    A_POSITIVE
    A_NEGATIVE
    B_POSITIVE
    B_NEGATIVE
    AB_POSITIVE
    AB_NEGATIVE
    O_POSITIVE
    O_NEGATIVE
    UNKNOWN
}

model Patient {
    id                String      @id @default(uuid())
    userId            String      @unique
    firstName         String
    lastName          String
    email             String      @unique
    dateOfBirth       DateTime?
    gender            Gender?
    bloodGroup        BloodGroup? @default(UNKNOWN)
    status            Status      @default(ACTIVE)
    phone             String?
    address           Json?
    emergencyContacts Json?
    insurance         Insurance[]
    createdAt         DateTime    @default(now())
    updatedAt         DateTime    @updatedAt

    @@index(userId)
    @@index([phone, email])
    @@index([firstName, lastName])
    @@index(dateOfBirth)
    @@map("patients")
}

model Insurance {
    id             String    @id @default(uuid())
    patientId      String    @unique
    patient        Patient   @relation(fields: [patientId], references: [id])
    policyNumber   String?   @unique
    providerName   String?
    policyHolder   String?
    groupNumber    String?
    expirationDate DateTime?

    @@index(patientId)
    @@index([providerName, policyNumber])
    @@map("patient_insurances")
}
