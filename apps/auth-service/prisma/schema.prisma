generator client {
    provider = "prisma-client-js"
    output   = "../../../node_modules/@generated/auth-client"
}

datasource db {
    provider = "postgresql"
    url      = env("AUTH_DATABASE_URL")
}

enum Role {
    PATIENT
    DOCTOR
    ADMIN
    CLINICIAN
}

enum Status {
    ACTIVE
    INACTIVE
    SUSPENDED
}

model User {
    id        String        @id @default(uuid())
    email     String        @unique
    password  String
    firstName String
    lastName  String
    roles     Role[]        @default([PATIENT])
    status    Status        @default(ACTIVE)
    lastLogin DateTime?
    createdAt DateTime      @default(now())
    updatedAt DateTime      @updatedAt
    sessions  UserSession[]

    @@index([email])
    @@index([status])
    @@map("users")
}

model UserSession {
    id               String   @id @default(uuid())
    userId           String
    user             User     @relation(fields: [userId], references: [id], onDelete: Cascade)
    refreshTokenHash String
    deviceId         String
    expiresAt        DateTime
    lastUsedAt       DateTime @default(now())
    createdAt        DateTime @default(now())
    updatedAt        DateTime @updatedAt

    @@index([userId])
    @@map("user_sessions")
}
